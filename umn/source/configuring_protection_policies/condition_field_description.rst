:original_name: waf_01_3271.html

.. _waf_01_3271:

Condition Field Description
===========================

When setting a precise access, CC attack protection, or global protection whitelist rule, configure some fields in the condition list area. These fields together are used to define the request attributes to trigger the rule. This topic describes the fields that you can specify in conditions to trigger a rule.

What Is a Condition Field?
--------------------------

A condition field specifies the request attribute WAF checks based on protection rules. When configuring a :ref:`CC attack protection rule <waf_01_0009>`, :ref:`precise access protection rule <waf_01_0010>`, or :ref:`global protection whitelist <waf_01_0016>`, you can define condition fields to specify request attributes to trigger the rule.

If a request meets the conditions set in a rule, the request hits the rule. WAF will then handle the request based on the action (**Allow**, **Block**, or **Log only**) configured for the rule.


.. figure:: /_static/images/en-us_image_0000002395175065.png
   :alt: **Figure 1** Condition field

   **Figure 1** Condition field

A condition field consists of **Field**, **Subfield**, **Logic**, and **Content**. Example:

-  Example 1: If **Field** is set to **Path**, **logic** to **Include**, and **Content** to **/admin**, a request matches the rule when the requested path contains **/admin**.
-  Example 2: If **Field** is set to **IPv4**, **Subfield** to **Client IP Address**, **Logic** to **Equal to**, and **Content** to **192.XX.XX.3**. When the client IP address is 192.XX.XX.3, the request hits the rule.

Supported Condition Fields
--------------------------

.. _waf_01_3271__table13543174312394:

.. table:: **Table 1** Condition list configurations

   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | Field               | Description                                                                                                                                                                                                               | Subfield        | Logic                                                                                                                                                                                                                                                                                    | Content (Example)                                                                       |
   +=====================+===========================================================================================================================================================================================================================+=================+==========================================================================================================================================================================================================================================================================================+=========================================================================================+
   | **Path**            | The path of a resource requested by the client. A path is part of a URL.                                                                                                                                                  | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | /buy/phone/                                                                             |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | Configuration description:                                                                                                                                                                                                |                 | -  **Include**, **Exclude**, **Equal to**, **Not equal to**, **Prefix is**, **Prefix is not**, **Suffix is**, or **Suffix is not**                                                                                                                                                       |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | -  The path does not contain a domain name and supports only exact match. So, the path to be protected must be the same as the path you configure. If the path to be protected is **/admin**, set **Path** to **/admin**. |                 | -  **Include any value**, **Exclude any value**, **Equal to any value**, **Not equal to any value**, **Prefix is any value**, **Prefix is not any value**, **Suffix is any value**, or **Suffix is not any value**                                                                       |                                                                                         |
   |                     | -  If **Path** is set to **/**, all paths of the website are protected.                                                                                                                                                   |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | -  The path content cannot contain the following special characters: (<>*)                                                                                                                                                |                 |    If you select any logical relationship listed above, you can specify **Reference Table** for **Content**. For details about how to add a reference table and manage reference tables, see :ref:`Creating a Reference Table to Configure Protection Metrics in Batches <waf_01_0081>`. |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length equal toSubfield length not equal toSubfield length greater thanSubfield length less than**                                                                                                                                                                         |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **User Agent**      | The client type, for example, browser, crawler, and mobile app.                                                                                                                                                           | --              |                                                                                                                                                                                                                                                                                          | *Mozilla/5.0 (Windows NT 6.1)*                                                          |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Referer**         | The source from which the request is sent. If you do not want visitors to access the page from **www.test.com**, set **Content** corresponding to **Referer** to **http://www.test.com**.                                 | --              |                                                                                                                                                                                                                                                                                          | **/admin/xxx**                                                                          |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **IP**              |                                                                                                                                                                                                                           | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | Client IP address to be matched, for example, *XXX.XXX.1.1*.                            |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Equal to** or **Not equal to**                                                                                                                                                                                                                                                      |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Equal to any value** or **Not equal to any value**                                                                                                                                                                                                                                  |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |    If you select any logical relationship listed above, you can specify **Reference Table** for **Content**. For details about how to add a reference table and manage reference tables, see :ref:`Creating a Reference Table to Configure Protection Metrics in Batches <waf_01_0081>`. |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Params**          | The query parameter in the URL. The query parameter is the content following the question mark (?).                                                                                                                       | -  All fields   | The following logical relationships are supported:                                                                                                                                                                                                                                       | *201901150929*                                                                          |
   |                     |                                                                                                                                                                                                                           | -  Any subfield |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           | -  Custom       | -  **Include**, **Exclude**, **Equal to**, **Not equal to**, **Prefix is**, **Prefix is not**, **Suffix is**, or **Suffix is not**                                                                                                                                                       |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Include any value**, **Exclude any value**, **Equal to any value**, **Not equal to any value**, **Prefix is any value**, **Prefix is not any value**, **Suffix is any value**, or **Suffix is not any value**                                                                       |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |    If you select any logical relationship listed above, you can specify **Reference Table** for **Content**. For details about how to add a reference table and manage reference tables, see :ref:`Creating a Reference Table to Configure Protection Metrics in Batches <waf_01_0081>`. |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length equal toSubfield length not equal toSubfield length greater thanSubfield length less thanNumber of params not equal toNumber of params greater thanNumber of params less thanHasDoes not have**                                                                     |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Cookie**          | The cookie in the request.                                                                                                                                                                                                | -  All fields   |                                                                                                                                                                                                                                                                                          | *jsessionid*                                                                            |
   |                     |                                                                                                                                                                                                                           | -  Any subfield |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           | -  Custom       |                                                                                                                                                                                                                                                                                          |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Header**          | The request header content.                                                                                                                                                                                               | -  All fields   |                                                                                                                                                                                                                                                                                          | *text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8* |
   |                     |                                                                                                                                                                                                                           | -  Any subfield |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           | -  Custom       |                                                                                                                                                                                                                                                                                          |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Method**          | The request method.                                                                                                                                                                                                       | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | **GET**, **POST**, **PUT**, **DELETE**, and **PATCH**                                   |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Equal to**                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Not equal to**                                                                                                                                                                                                                                                                      |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Protocol**        | The request protocol.                                                                                                                                                                                                     | --              |                                                                                                                                                                                                                                                                                          | **HTTP** and **HTTPS**                                                                  |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Request Line**    | The request line length. The value must be an integer ranging from 0 to 65,535.                                                                                                                                           | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | **50**                                                                                  |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length equal to**                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length not equal to**                                                                                                                                                                                                                                                      |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length greater than**                                                                                                                                                                                                                                                      |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length less than**                                                                                                                                                                                                                                                         |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Request**         | The request length. The value must be an integer ranging from 0 to 2,147,483,647.                                                                                                                                         | --              |                                                                                                                                                                                                                                                                                          | *50*                                                                                    |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | The maximum value for cloud load balancer access mode is 4,000 bytes. If the value exceeds the maximum, the configuration does not take effect.                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Response Length** | The response length. The value must be an integer ranging from 0 to 2,147,483,647.                                                                                                                                        | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | *50*                                                                                    |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | -  Response detection occurs after the response header is returned. The response header cannot be modified when it is blocked.                                                                                            |                 | -  **Subfield length equal to**                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | -  A response body returned from the origin server may be included in protection events. As the response body is streamed, WAF cannot change it once it has been sent.                                                    |                 | -  **Subfield length not equal to**                                                                                                                                                                                                                                                      |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length greater than**                                                                                                                                                                                                                                                      |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Subfield length less than**                                                                                                                                                                                                                                                         |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Response Time**   | The response time. The value must be an integer ranging from 0 to 60,000, in ms.                                                                                                                                          | --              |                                                                                                                                                                                                                                                                                          | *100*                                                                                   |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | -  Response detection occurs after the response header is returned. The response header cannot be modified when it is blocked.                                                                                            |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | -  A response body returned from the origin server may be included in protection events. As the response body is streamed, WAF cannot change it once it has been sent.                                                    |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Response Code**   | The status code returned to the request.                                                                                                                                                                                  | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | *404*                                                                                   |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | For requests sent after this rule is triggered, WAF stops checking their HTTP response code until the current traffic limit duration you configure in the rule ends.                                                      |                 | -  **Equal to** or **Not equal to**                                                                                                                                                                                                                                                      |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Equal to any value** or **Not equal to any value**                                                                                                                                                                                                                                  |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |    If you select any logical relationship listed above, you can specify **Reference Table** for **Content**. For details about how to add a reference table and manage reference tables, see :ref:`Creating a Reference Table to Configure Protection Metrics in Batches <waf_01_0081>`. |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Response Header** | The response header.                                                                                                                                                                                                      | -  All fields   | The following logical relationships are supported:                                                                                                                                                                                                                                       | --                                                                                      |
   |                     |                                                                                                                                                                                                                           | -  Any subfield |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | WAF checks responses after response headers are returned. If WAF needs to block responses, response headers cannot be changed.                                                                                            | -  Custom       | -  **Include**, **Exclude**, **Equal to**, **Not equal to**, **Prefix is**, **Prefix is not**, **Suffix is**, or **Suffix is not**                                                                                                                                                       |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Include any value**, **Exclude any value**, **Equal to any value**, **Not equal to any value**, **Prefix is any value**, **Prefix is not any value**, or **Suffix is any value**,                                                                                                   |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |    If you select any logical relationship listed above, you can specify **Reference Table** for **Content**. For details about how to add a reference table and manage reference tables, see :ref:`Creating a Reference Table to Configure Protection Metrics in Batches <waf_01_0081>`. |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Response Body**   | The response message body.                                                                                                                                                                                                | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | --                                                                                      |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     | WAF checks responses after response headers are returned. If WAF needs to block responses, response headers cannot be changed.                                                                                            |                 | -  **Include** or **Exclude**                                                                                                                                                                                                                                                            |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Include any value** or **Exclude any value**                                                                                                                                                                                                                                        |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |    If you select any logical relationship listed above, you can specify **Reference Table** for **Content**. For details about how to add a reference table and manage reference tables, see :ref:`Creating a Reference Table to Configure Protection Metrics in Batches <waf_01_0081>`. |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Request Body**    | The request message body.                                                                                                                                                                                                 | --              | The following logical relationships are supported:                                                                                                                                                                                                                                       | --                                                                                      |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Include** or **Not Include**                                                                                                                                                                                                                                                        |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 | -  **Include any value** or **Exclude any value**                                                                                                                                                                                                                                        |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |                                                                                                                                                                                                                                                                                          |                                                                                         |
   |                     |                                                                                                                                                                                                                           |                 |    If you select any logical relationship listed above, you can specify **Reference Table** for **Content**. For details about how to add a reference table and manage reference tables, see :ref:`Creating a Reference Table to Configure Protection Metrics in Batches <waf_01_0081>`. |                                                                                         |
   +---------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
