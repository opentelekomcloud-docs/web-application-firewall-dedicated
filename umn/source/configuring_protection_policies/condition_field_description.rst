:original_name: waf_01_3271.html

.. _waf_01_3271:

Condition Field Description
===========================

When setting a CC attack, precise access, or global whitelist protection rule, there are some fields in the **Condition List** or **Trigger** area. These fields together are used to define the request attributes to trigger the rule. This topic describes the fields that you can specify in conditions to trigger a rule.

What Is a Condition Field?
--------------------------

A condition field specifies the request attribute WAF checks against protection rules. When configuring a :ref:`CC attack protection rule <waf_01_0009>`, :ref:`precise access protection rule <waf_01_0010>`, or :ref:`global protection whitelist <waf_01_0016>`, you can define condition fields to specify request attributes to trigger the rule. If a request meets the conditions set in a rule, the request matches the rule. WAF handles the request based on the action (for example, allow, block, or log only) set in the rule.


.. figure:: /_static/images/en-us_image_0000001675705730.png
   :alt: **Figure 1** Condition field

   **Figure 1** Condition field

A condition field consists of the field, subfield, logic, and content. Example:

-  Example 1: If **Field** is set to **Path**, **logic** to **Include**, and **Content** to **/admin**, a request matches the rule when the requested path contains /admin.
-  Example 2: Set **Field** to **IPv4**, **Subfield** to **Client IP Address**, **Logic** to **Equal to**, and **Content** to **192.XX.XX.3**. When the client IP address is 192.XX.XX.3, the request hits the rule.

Supported Condition Fields
--------------------------

.. _waf_01_3271__table13543174312394:

.. table:: **Table 1** Condition list configurations

   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | Field                                                                                                                                                                                            | Subfield        | Logic                                                                      | Content (Example)                                                                       |
   +==================================================================================================================================================================================================+=================+============================================================================+=========================================================================================+
   | **Path**: Part of a URL that does not include a domain name. This value supports exact matches only. For example, if the path to be protected is **/admin**, **Path** must be set to **/admin**. | --              | Select the desired logical relationship from the **Logic** drop-down list. | */buy/phone/*                                                                           |
   |                                                                                                                                                                                                  |                 |                                                                            |                                                                                         |
   |                                                                                                                                                                                                  |                 |                                                                            | .. important::                                                                          |
   |                                                                                                                                                                                                  |                 |                                                                            |                                                                                         |
   |                                                                                                                                                                                                  |                 |                                                                            |    NOTICE:                                                                              |
   |                                                                                                                                                                                                  |                 |                                                                            |                                                                                         |
   |                                                                                                                                                                                                  |                 |                                                                            |    -  If **Path** is set to **/**, all paths of the website are protected.              |
   |                                                                                                                                                                                                  |                 |                                                                            |    -  The path content cannot contain the following special characters: (<>*)           |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **User Agent**: A user agent of the scanner to be protected                                                                                                                                      | --              |                                                                            | *Mozilla/5.0 (Windows NT 6.1)*                                                          |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **IP**: An IP address of the visitor to be protected.                                                                                                                                            | --              |                                                                            | XXX.XXX.1.1                                                                             |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Params**: A request parameter to be protected                                                                                                                                                  | -  All fields   |                                                                            | 201901150929                                                                            |
   |                                                                                                                                                                                                  | -  Any subfield |                                                                            |                                                                                         |
   |                                                                                                                                                                                                  | -  Custom       |                                                                            |                                                                                         |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Referer**: A user-defined request resource                                                                                                                                                     | --              |                                                                            | http://www.test.com                                                                     |
   |                                                                                                                                                                                                  |                 |                                                                            |                                                                                         |
   | For example, if the protected path is **/admin/xxx** and you do not want visitors to access the page from **www.test.com**, set **Content** for **Referer** to **http://www.test.com**.          |                 |                                                                            |                                                                                         |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Cookie**: A small piece of data to identify web visitors                                                                                                                                       | -  All fields   |                                                                            | jsessionid                                                                              |
   |                                                                                                                                                                                                  | -  Any subfield |                                                                            |                                                                                         |
   |                                                                                                                                                                                                  | -  Custom       |                                                                            |                                                                                         |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Header**: A user-defined HTTP header                                                                                                                                                           | -  All fields   |                                                                            | *text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8* |
   |                                                                                                                                                                                                  | -  Any subfield |                                                                            |                                                                                         |
   |                                                                                                                                                                                                  | -  Custom       |                                                                            |                                                                                         |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Method**: the user-defined request method.                                                                                                                                                     | --              |                                                                            | **GET**, **POST**, **PUT**, **DELETE**, and **PATCH**                                   |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Request Line**: Length of a user-defined request line.                                                                                                                                         | --              |                                                                            | 50                                                                                      |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Request**: Length of a user-defined request. It includes the request header, request line, and request body.                                                                                   | --              |                                                                            | --                                                                                      |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
   | **Protocol**: the protocol of the request.                                                                                                                                                       | --              |                                                                            | http                                                                                    |
   +--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+
