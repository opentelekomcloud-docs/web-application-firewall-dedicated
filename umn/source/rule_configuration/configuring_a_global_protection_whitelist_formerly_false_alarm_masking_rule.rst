:original_name: waf_01_0016.html

.. _waf_01_0016:

Configuring a Global Protection Whitelist (Formerly False Alarm Masking) Rule
=============================================================================

Once an attack hits a WAF basic web protection rule or a feature-library anti-crawler rule, WAF will respond to the attack immediately according to the protective action (**Log only** or **Block**) you configured for the rule and display an event on the **Events** page.

You can add false alarm masking rules to let WAF ignore certain rule IDs or event types (for example, skip XSS checks for a specific URL).

-  If you select **All protection** for **Ignore WAF Protection**, all WAF rules do not take effect, and WAF allows all request traffic to the domain names in the rule.
-  If you select **Basic Web Protection** for **Ignore WAF Protection**, you can ignore basic web protection by rule ID, attack type, or all built-in rules. For example, if XSS check is not required for a URL, you can whitelist XSS rule.

Prerequisites
-------------

A website has been added to WAF.

Constraints
-----------

-  If you select **All protection** for **Ignore WAF Protection**, all WAF rules do not take effect, and WAF allows all request traffic to the domain names in the rule.
-  If you select **Basic web protection** for **Ignore WAF Protection**, global protection whitelist (formerly false alarm masking) rules take effect only for events triggered against WAF built-in rules in **Basic Web Protection** and anti-crawler rules under **Feature Library**.

   -  Basic web protection rules

      Basic web protection defends against common web attacks, such as SQL injection, XSS attacks, remote buffer overflow attacks, file inclusion, Bash vulnerability exploits, remote command execution, directory traversal, sensitive file access, and command and code injections. Basic web protection also detects web shells and evasion attacks.

   -  Feature-based anti-crawler protection

      Feature-based anti-crawler identifies and blocks crawler behavior from search engines, scanners, script tools, and other crawlers.

-  It takes several minutes for a new rule to take effect. After the rule takes effect, protection events triggered by the rule will be displayed on the **Events** page.
-  You can configure a global protection whitelist (formerly false alarm masking) rule by referring to :ref:`Handling False Alarms <waf_01_0024>`. After handling a false alarm, you can view the rule in the global protection whitelist (formerly false alarm masking) rule list.

Procedure
---------

#. Log in to the management console.

#. Click |image1| in the upper left corner of the management console and select a region or project.

#. Click |image2| in the upper left corner and choose **Web Application Firewall (Dedicated)** under **Security**.

#. In the navigation pane on the left, choose **Website Settings**.

#. In the **Policy** column of the row containing the target website, click the number to go to the **Policies** page.

#. In the **Global Protection Whitelist (Formerly False Alarm Masking)** configuration area, click **Status** if needed. Then, click **Customize Rule**.


   .. figure:: /_static/images/en-us_image_0000001326640436.png
      :alt: **Figure 1** Global Protection Whitelist configuration area

      **Figure 1** Global Protection Whitelist configuration area

#. In the upper left corner of the **Global Protection Whitelist** page, click **Add Rule**.

#. Add a global whitelist rule by referring to :ref:`Table 1 <waf_01_0016__table1623195815237>`.


   .. figure:: /_static/images/en-us_image_0000001326802772.png
      :alt: **Figure 2** Add Global Protection Whitelist Rule

      **Figure 2** Add Global Protection Whitelist Rule

   .. _waf_01_0016__table1623195815237:

   .. table:: **Table 1** Parameters

      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Parameter               | Description                                                                                                                                                                                                                                                                                                                                                               | Example Value                              |
      +=========================+===========================================================================================================================================================================================================================================================================================================================================================================+============================================+
      | Scope                   | -  **All domain names**: By default, this rule will be used to all domain names that are protected by the current policy.                                                                                                                                                                                                                                                 | Specified domain names                     |
      |                         | -  **Specified domain names**: This rule will be used to the specified domain names that match the wildcard domain name being protected by the current policy.                                                                                                                                                                                                            |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Domain Name             | This parameter is mandatory when you select **Specified domain names** for **Scope**.                                                                                                                                                                                                                                                                                     | www.example.com                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | Enter a single domain name that matches the wildcard domain name being protected by the current policy.                                                                                                                                                                                                                                                                   |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Condition List          | Click **Add** to add conditions. At least one condition needs to be added. You can add up to 30 conditions to a protection rule. If more than one condition is added, all of the conditions must be met for the rule to be applied. A condition includes the following parameters:                                                                                        | Path, Include, /product                    |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | Parameters for configuring a condition are described as follows:                                                                                                                                                                                                                                                                                                          |                                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | -  Field                                                                                                                                                                                                                                                                                                                                                                  |                                            |
      |                         | -  **Subfield**: Configure this field only when **Params**, **Cookie**, or **Header** is selected for **Field**.                                                                                                                                                                                                                                                          |                                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         |    .. important::                                                                                                                                                                                                                                                                                                                                                         |                                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         |       NOTICE:                                                                                                                                                                                                                                                                                                                                                             |                                            |
      |                         |       The length of a subfield cannot exceed 2,048 bytes. Only digits, letters, underscores (_), and hyphens (-) are allowed.                                                                                                                                                                                                                                             |                                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | -  **Logic**: Select a logical relationship from the drop-down list.                                                                                                                                                                                                                                                                                                      |                                            |
      |                         | -  **Content**: Enter or select the content that matches the condition.                                                                                                                                                                                                                                                                                                   |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Ignore WAF Protection   | -  **All protection**: All WAF rules do not take effect, and WAF allows all request traffic to the domain names in the rule.                                                                                                                                                                                                                                              | Basic Web Protection                       |
      |                         | -  **Basic Web Protection**: You can ignore basic web protection by rule ID, attack type, or all built-in rules. For example, if XSS check is not required for a URL, you can whitelist XSS rule.                                                                                                                                                                         |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Ignored Protection Type | If you select **Basic web protection** for **Ignored Protection Type**, specify the following parameters:                                                                                                                                                                                                                                                                 | Attack type                                |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | -  **ID**: Configure the rule by event ID.                                                                                                                                                                                                                                                                                                                                |                                            |
      |                         | -  **Attack type**: Configure the rule by attack type, such as XSS and SQL injection. One type contains one or more rule IDs.                                                                                                                                                                                                                                             |                                            |
      |                         | -  **All built-in rules**: all checks enabled in :ref:`Basic Web Protection <waf_01_0008>`.                                                                                                                                                                                                                                                                               |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | ID                      | This parameter is mandatory when you select **ID** for **Ignored Protection Type**.                                                                                                                                                                                                                                                                                       | 041046                                     |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | ID of an attack event on the **Events** page. If the event type is **Custom**, it has no event ID. Click **Handle False Alarm** in the row containing the attack event to obtain the ID. You are advised to configure global protection whitelist (formerly false alarm masking) rules on the **Events** page by referring to :ref:`Handling False Alarms <waf_01_0024>`. |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Attack type             | This parameter is mandatory when you select **Attack type** for **Ignored Protection Type**.                                                                                                                                                                                                                                                                              | SQL injection                              |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | Select an attack type from the drop-down list box.                                                                                                                                                                                                                                                                                                                        |                                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | WAF can defend against XSS attacks, web shells, SQL injection attacks, malicious crawlers, remote file inclusions, local file inclusions, command injection attacks, and other attacks.                                                                                                                                                                                   |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Rule Description        | A brief description of the rule. This parameter is optional.                                                                                                                                                                                                                                                                                                              | SQL injection attacks are not intercepted. |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+
      | Advanced Settings       | To ignore attacks of a specific field, specify the field in the **Advanced Settings** area. After you add the rule, WAF will stop blocking attack events of the specified field.                                                                                                                                                                                          | Params                                     |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | Select a target field from the first drop-down list box on the left. The following fields are supported: **Params**, **Cookie**, **Header**, **Body**, and **Multipart**.                                                                                                                                                                                                 | All                                        |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | -  If you select **Params**, **Cookie**, or **Header**, you can select **All** or **Specified field** to configure a subfield.                                                                                                                                                                                                                                            |                                            |
      |                         | -  If you select **Body** or **Multipart**, you can select **All**.                                                                                                                                                                                                                                                                                                       |                                            |
      |                         | -  If you select **Cookie**, the **Domain Name** and **Path** can be empty.                                                                                                                                                                                                                                                                                               |                                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         | .. note::                                                                                                                                                                                                                                                                                                                                                                 |                                            |
      |                         |                                                                                                                                                                                                                                                                                                                                                                           |                                            |
      |                         |    If **All** is selected, WAF will not block all attack events of the selected field.                                                                                                                                                                                                                                                                                    |                                            |
      +-------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------+

#. Click **OK**.

Other Operations
----------------

-  To disable a rule, click **Disable** in the **Operation** column of the rule. The default **Rule Status** is **Enabled**.
-  To modify a global protection whitelist (formerly false alarm masking) rule, click **Modify** in the row containing the rule.
-  To delete a global protection whitelist (formerly false alarm masking) rule, click **Delete** in the row containing the rule.

.. |image1| image:: /_static/images/en-us_image_0000001482228424.jpg
.. |image2| image:: /_static/images/en-us_image_0000001288266226.png
